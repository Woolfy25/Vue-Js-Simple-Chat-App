import{g as b,j as k,k as M,r as m,l as C,m as S,c as l,a as e,t as n,n as T,F as j,p as B,q as O,s as z,v as N,x as A,o as i,y as D}from"./DeMtFh4g.js";import{u as I}from"./DrY93wuS.js";const L={class:"grid grid-rows-[auto_1fr_auto] h-full"},V={class:"px-6 py-4 border-b-2 border-gray-300 flex items-center justify-between"},$={class:"flex flex-row items-center gap-4"},F=["src","alt"],K={class:"text-lg font-semibold"},q={key:0,class:"flex items-start gap-2"},E=["src","alt"],H={class:"max-w-[70%]"},R={class:"flex items-baseline gap-2 mb-1"},U={class:"text-xs font-medium text-gray-600"},G={class:"text-xs text-gray-400"},J={class:"bg-gray-100 py-2 px-3 rounded-xl rounded-tl-none"},P={class:"text-gray-800"},Q={key:1,class:"flex flex-col items-end"},W={class:"max-w-[70%] flex flex-col"},X={class:"bg-sky-400 py-2 px-3 rounded-xl rounded-br-none text-white"},Y={class:"text-xs text-gray-500 mt-1 self-end"},Z={class:"p-5 border-t-2 border-gray-300"},ee={class:"flex gap-2 items-center"},te={class:"relative flex-grow"},le={__name:"[id]",async setup(se){let u,v;const d=I();[u,v]=b(()=>d.fetchChats()),await u,v();const h=k().params.id,t=M(()=>d.chats.find(r=>r.id===h)),a=m(""),c=m(null);C(()=>{var r;return(r=t.value)==null?void 0:r.messages},async()=>{await D(),p()},{deep:!0}),S(()=>{p()});function p(){c.value&&(c.value.scrollTop=c.value.scrollHeight)}function g(){a.value.trim()&&(d.sendMessage(h,a.value),a.value="")}const x=r=>{if(!r)return"";try{const o=r.replace(/T(\d{2}):(\d{2}):(\d{2})/,(re,w,_,f)=>{const y=Math.min(59,parseInt(f));return`T${w}:${_}:${y.toString().padStart(2,"0")}`}),s=new Date(o);return isNaN(s)?"":s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}};return(r,o)=>(i(),l("div",L,[e("div",V,[e("div",$,[e("img",{src:t.value.user.avatar,alt:t.value.user.name,class:"w-11 h-11 rounded-full object-cover"},null,8,F),e("div",null,[e("h2",K,n(t.value.user.name),1),e("p",{class:T(["text-xs",{"text-green-500":t.value.user.isOnline,"text-gray-500":!t.value.user.isOnline}])},n(t.value.user.isOnline?"Online":"Offline"),3)])]),o[1]||(o[1]=e("div",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"5",cy:"12",r:"1"}),e("circle",{cx:"12",cy:"12",r:"1"}),e("circle",{cx:"19",cy:"12",r:"1"})])],-1))]),e("div",{ref_key:"messagesContainer",ref:c,class:"overflow-y-auto p-5"},[(i(!0),l(j,null,B(t.value.messages,s=>(i(),l("div",{key:s.id,class:"mb-4"},[s.isInbox?(i(),l("div",q,[e("img",{src:t.value.user.avatar,alt:t.value.user.name,class:"w-8 h-8 rounded-full object-cover mt-5"},null,8,E),e("div",H,[e("div",R,[e("p",U,n(t.value.user.name),1),e("p",G,n(x(s.sentAt)),1)]),e("div",J,[e("p",P,n(s.content),1)])])])):(i(),l("div",Q,[e("div",W,[e("div",X,[e("p",null,n(s.content),1)]),e("p",Y,n(x(s.sentAt)),1)])]))]))),128))],512),e("div",Z,[e("div",ee,[e("div",te,[O(e("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>a.value=s),placeholder:"Type something here...",class:"w-full p-2 pr-16 border border-gray-300 bg-gray-100 rounded focus:outline-none focus:ring-2 focus:ring-sky-400",onKeyup:A(g,["enter"])},null,544),[[N,a.value]]),o[2]||(o[2]=z('<div class="absolute inset-y-0 right-0 flex items-center pr-2 space-x-1"><button type="button" class="text-gray-400 hover:text-gray-600 p-1"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"></path></svg></button><button type="button" class="text-gray-400 hover:text-gray-600 p-1"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></button></div>',1))]),e("button",{onClick:g,class:"p-2 bg-sky-400 text-white rounded-sm hover:bg-sky-500",title:"Send"},o[3]||(o[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)]))])])]))}};export{le as default};
